---
title: "Assignment 10: How much for that car?"
author: "Madina Kanafina"
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---

```{r setup, include = FALSE}
# DO NOT ALTER THIS CHUNK
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
is_pdf <- try (("pdf_document" %in% rmarkdown::all_output_formats(knitr::current_input())), silent=TRUE)
is_pdf <- (is_pdf == TRUE)
# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(modelr))
suppressPackageStartupMessages(library(plotly))
# Load dataset
car_prices <- read_rds("car_price_data.rds")
```


## Exercise 1

i. Price and mileage are the two continuous variables in car_prices dataset.

ii. 
```{r}
car_prices %>%
  pivot_longer(
    cols = Mileage | Liter,
    names_to = "name",
    values_to = "value") %>%
  ggplot() +
  geom_point(mapping = aes(x = value, y = Price)) +
  facet_wrap(~name, scales = "free_x") +
  labs(title = "Price and Car Mileage/Fuel Capacity",
       x = "Value (Liter and Mileage)",
       y = "Price")
```

## Exercise 2

```{r}
continuous_model <- lm(Price ~ Mileage + Liter, data = car_prices)
continuous_model %>%
  glance() %>%
  select(r.squared)
continuous_model %>%
  tidy()
```
## Exercise 3

```{r}
# predict model plane over values
lit <- unique(car_prices$Liter)
mil <- unique(car_prices$Mileage)
grid <- with(car_prices, expand.grid(lit, mil))
d <- setNames(data.frame(grid), c("Liter", "Mileage"))
vals <- predict(continuous_model, newdata = d)

# form surface matrix and give to plotly
m <- matrix(vals, nrow = length(unique(d$Liter)), ncol = length(unique(d$Mileage)))
p <- plot_ly() %>%
  add_markers(
    x = ~car_prices$Mileage, 
    y = ~car_prices$Liter, 
    z = ~car_prices$Price, 
    marker = list(size = 1)
    ) %>%
  add_trace(
    x = ~mil, y = ~lit, z = ~m, type="surface", 
    colorscale=list(c(0,1), c("yellow","yellow")),
    showscale = FALSE
    ) %>%
  layout(
    scene = list(
      xaxis = list(title = "mileage"),
      yaxis = list(title = "liters"),
      zaxis = list(title = "price")
    )
  )
if (!is_pdf) {p}
```

## Exercise 4

```{r}
continuous_df <- augment(continuous_model, car_prices)
```
  
## Exercise 5

```{r}
continuous_df %>%
  ggplot() +
  geom_point(mapping = aes(x = .fitted, y = Price)) +
  geom_abline(slope = 1, intercept = 0) +
  labs(title = "Observed vs Predicted",
       x = "Predicted Price Values",
       y = "Actual Prices")
```

i. Linearity: This "Observed vs Predicted" plot's linearity does not capture the actual relationship between the explanatory and response variables because many points deviate significantly from the line, especially as the predicted values increase.

ii. Nearly normal residuals: There is a curve in the spread of points, where the actual prices tend to be higher than predicted for certain ranges.

iii. Constant Variation of Residuals: the spread of actual prices around the predicted line appears to increase as the predicted prices increases. this pattern violates the assumption of constant residual variation.

iv. Independent Observations: The plot doesn't provide enough evidence for or against this assumption. 

## Exercise 6




## Exercise 7




## Exercise 8




## Exercise 9




## Exercise 10




## Exercise 11




## Exercise 12




## Academic Integrity statement


